!function(e){function t(t){for(var r,i,o=t[0],l=t[1],c=t[2],m=0,p=[];m<o.length;m++)i=o[m],n[i]&&p.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);p.length;)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={0:0},s=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([75,1]),a()}({1:function(e,t){e.exports=django},3:function(e,t){e.exports=jQuery},75:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(4),i=a.n(s),o=a(3),l=a.n(o);function c(e){l.a.ajaxSetup({beforeSend:function(t,a){var r;r=a.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(r)||this.crossDomain||t.setRequestHeader("X-CSRFToken",function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),r=0;r<a.length;r++){var n=jQuery.trim(a[r]);if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}(e))}})}var u=a(1),m=a.n(u),p=a(7),d=a.n(p),h=a(16),f=a.n(h);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var k=function(e){function t(e){var a,r,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(a=!(s=y(t).call(this,e))||"object"!==_(s)&&"function"!=typeof s?g(r):s).state={name:"",email:"",url:"",followup:!1,comment:"",reply_to:a.props.reply_to||0,visited:{name:!1,email:!1,comment:!1},errors:{name:!1,email:!1,comment:!1},previewing:!1,alert:{message:"",cssc:""}},a.handle_input_change=a.handle_input_change.bind(g(g(a))),a.handle_blur=a.handle_blur.bind(g(g(a))),a.handle_submit=a.handle_submit.bind(g(g(a))),a.handle_preview=a.handle_preview.bind(g(g(a))),a.reset_form=a.reset_form.bind(g(g(a))),a.fhelp=n.a.createElement("span",{className:"form-text small invalid-feedback"},m.a.gettext("This field is required.")),a}var a,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,n.a.Component),a=t,(r=[{key:"handle_input_change",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,r=t.name;this.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},r,a))}},{key:"handle_blur",value:function(e){return function(t){var a=this.state.visited;a[e]=!0,this.setState({visited:a})}.bind(this)}},{key:"validate",value:function(){var e=this.state.errors;return e.name=!1,e.email=!1,this.state.comment.length?e.comment=!1:e.comment=!0,this.props.is_authenticated&&!this.props.request_name||(/^\s*$/.test(this.state.name)?e.name=!0:e.name=!1),this.props.is_authenticated&&!this.props.request_email_address||(/\S+@\S+\.\S+/.test(this.state.email)?e.email=!1:e.email=!0),this.setState({errors:e}),!(this.state.errors.comment||this.state.errors.name||this.state.errors.email)}},{key:"render_field_comment",value:function(){var e="form-group row",t="form-control",a="";this.state.reply_to>0&&(t+=" form-control-sm"),this.state.errors.comment&&(e+=this.state.errors.comment?" has-danger":"",t+=" is-invalid",a=this.fhelp);var r=m.a.gettext("Your comment");return n.a.createElement("div",{className:e},n.a.createElement("div",{className:"offset-md-1 col-md-10"},n.a.createElement("textarea",{required:!0,name:"comment",id:"id_comment",placeholder:r,maxLength:"3000",className:t,value:this.state.comment,onChange:this.handle_input_change,onBlur:this.handle_blur("comment")}),a))}},{key:"render_field_name",value:function(){if(this.props.is_authenticated&&!this.props.request_name)return"";var e="form-group row",t="col-form-label col-md-3 text-right",a="form-control",r="",s=m.a.gettext("name");return this.state.reply_to>0&&(t+=" form-control-sm",a+=" form-control-sm"),this.state.errors.name&&(e+=" has-danger",a+=" is-invalid",r=this.fhelp),n.a.createElement("div",{className:e},n.a.createElement("label",{htmlFor:"id_name",className:t},m.a.gettext("Name")),n.a.createElement("div",{className:"col-md-7"},n.a.createElement("input",{type:"text",name:"name",required:!0,id:"id_name",value:this.state.name,placeholder:s,onChange:this.handle_input_change,onBlur:this.handle_blur("name"),className:a}),r))}},{key:"render_field_email",value:function(){if(this.props.is_authenticated&&!this.props.request_email_address)return"";var e="form-group row",t="col-form-label col-md-3 text-right",a="form-control",r="form-text small",s={},i=m.a.gettext("mail address"),o=m.a.gettext("Required for comment verification.");return this.state.reply_to>0&&(t+=" form-control-sm",a+=" form-control-sm",s={fontSize:"0.710rem"}),this.state.errors.email&&(e+=" has-danger",a+=" is-invalid",r+=" invalid-feedback"),n.a.createElement("div",{className:e},n.a.createElement("label",{htmlFor:"id_email",className:t},m.a.gettext("Mail")),n.a.createElement("div",{className:"col-md-7"},n.a.createElement("input",{type:"text",name:"email",required:!0,id:"id_email",value:this.state.email,placeholder:i,onChange:this.handle_input_change,onBlur:this.handle_blur("email"),className:a}),n.a.createElement("span",{className:r,style:s},o)))}},{key:"render_field_url",value:function(){if(this.props.is_authenticated)return"";var e="col-form-label col-md-3 text-right",t="form-control";if(this.state.reply_to>0&&(e+=" form-control-sm",t+=" form-control-sm"),this.state.errors.url)var a=m.a.gettext("url your name links to (optional)");return n.a.createElement("div",{className:"form-group row"},n.a.createElement("label",{htmlFor:"id_url",className:e},m.a.gettext("Link")),n.a.createElement("div",{className:"col-md-7"},n.a.createElement("input",{type:"text",name:"url",id:"id_url",value:this.state.url,placeholder:a,onChange:this.handle_input_change,className:t})))}},{key:"render_field_followup",value:function(){var e=m.a.gettext("Notify me about follow-up comments"),t="custom-control-label";return this.state.reply_to>0&&(t+=" small"),n.a.createElement("div",{className:"form-group row"},n.a.createElement("div",{className:"offset-md-3 col-md-7"},n.a.createElement("div",{className:"custom-control custom-checkbox"},n.a.createElement("input",{className:"custom-control-input",type:"checkbox",checked:this.state.followup,onChange:this.handle_input_change,name:"followup",id:"id_followup"}),n.a.createElement("label",{className:t,htmlFor:"id_followup"}," ",e))))}},{key:"reset_form",value:function(){this.setState({name:"",email:"",url:"",followup:!1,comment:"",visited:{name:!1,email:!1,comment:!1},errors:{name:!1,email:!1,comment:!1}})}},{key:"handle_submit_response",value:function(e){var t="",a={202:m.a.gettext("Your comment will be reviewed. Thank your for your patience."),204:m.a.gettext("Thank you, a comment confirmation request has been sent by mail."),403:m.a.gettext("Sorry, your comment has been rejected.")};t=403==e?"alert alert-danger":"alert alert-info",this.setState({alert:{message:a[e],cssc:t},previewing:!1}),this.reset_form(),this.props.on_comment_created()}},{key:"handle_submit",value:function(e){if(e.preventDefault(),this.validate()){var t={content_type:this.props.form.content_type,object_pk:this.props.form.object_pk,timestamp:this.props.form.timestamp,security_hash:this.props.form.security_hash,honeypot:"",comment:this.state.comment,name:this.state.name,email:this.state.email,url:this.state.url,followup:this.state.followup,reply_to:this.state.reply_to};l.a.ajax({method:"POST",url:this.props.send_url,data:t,dataType:"json",cache:!1,success:function(e,t,a){[201,202,204].indexOf(a.status)>-1&&this.handle_submit_response(a.status)}.bind(this),error:function(e,t,a){if(400==e.status){var r=this.state.errors;e.responseJSON.forEach(function(e,t,a){r[e]=!0}),this.setState({errors:r})}else 403==e.status?this.handle_submit_response(e.status):console.error(this.props.send_url,t,a.toString())}.bind(this)})}}},{key:"handle_preview",value:function(e){e.preventDefault(),this.validate()&&this.setState({previewing:!0})}},{key:"rawMarkup",value:function(){var e=(new d.a).render(this.state.comment);return{__html:e}}},{key:"render_preview",value:function(){if(!this.state.previewing)return"";var e="",t="http://www.gravatar.com/avatar/"+f()(this.state.email.toLowerCase())+"?s=48&d=mm",a=n.a.createElement("img",{className:"mr-3",src:t,height:"48",width:"48"});e=this.state.url?n.a.createElement("a",{href:this.state.url,target:"_new"},this.state.name):this.props.is_authenticated?this.props.current_user.split(":")[1]:this.state.name;var r="",s=m.a.gettext("Your comment in preview"),i=n.a.createElement("h5",{className:"text-center"},s);this.state.reply_to>0&&(i="",r=n.a.createElement("div",{className:"badge badge-info"},"preview"));var o=m.a.gettext("Now");return n.a.createElement("div",null,n.a.createElement("hr",null),i,n.a.createElement("div",{className:"media"},a,n.a.createElement("div",{className:"media-body"},n.a.createElement("div",{className:"comment pb-3"},n.a.createElement("h6",{className:"mb-1 small"},o," - ",e,"  ",r),n.a.createElement("div",{className:"preview",dangerouslySetInnerHTML:this.rawMarkup()})))))}},{key:"render_form",value:function(){var e=this.render_field_comment(),t=this.render_field_name(),a=this.render_field_email(),r=this.render_field_url(),s=this.render_field_followup(),i="form-group row",o="btn btn-primary",l="btn btn-secondary";0!=this.state.reply_to&&(i+=" mb-0",o+=" btn-sm",l+=" btn-sm");var c=m.a.gettext("preview"),u=m.a.gettext("send");return n.a.createElement("form",{method:"POST",onSubmit:this.handle_submit},n.a.createElement("input",{type:"hidden",name:"content_type",defaultValue:this.props.form.content_type}),n.a.createElement("input",{type:"hidden",name:"object_pk",defaultValue:this.props.form.object_pk}),n.a.createElement("input",{type:"hidden",name:"timestamp",defaultValue:this.props.form.timestamp}),n.a.createElement("input",{type:"hidden",name:"security_hash",defaultValue:this.props.form.security_hash}),n.a.createElement("input",{type:"hidden",name:"reply_to",defaultValue:this.state.reply_to}),n.a.createElement("fieldset",null,n.a.createElement("div",{style:{display:"none"}},n.a.createElement("input",{type:"text",name:"honeypot",defaultValue:""})),e," ",t," ",a," ",r," ",s),n.a.createElement("div",{className:i},n.a.createElement("div",{className:"offset-md-3 col-md-7"},n.a.createElement("button",{type:"submit",name:"post",className:o},u)," ",n.a.createElement("button",{name:"preview",className:l,onClick:this.handle_preview},c))))}},{key:"render",value:function(){var e=this.render_preview(),t="",a="card card-block mt-2",r=m.a.gettext("Post your comment");0==this.state.reply_to&&(t=n.a.createElement("h4",{className:"card-title text-center pb-3"},r),a="card card-block mt-4 mb-5");var s="";this.state.alert.message&&(s=n.a.createElement("div",{className:this.state.alert.cssc},this.state.alert.message));var i=this.render_form();return n.a.createElement("div",null,e,n.a.createElement("div",{className:a},n.a.createElement("div",{className:"card-body"},t,s,i)))}}])&&v(a.prototype,r),s&&v(a,s),t}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function x(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var j=function(e){function t(e){var a,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(a=!(n=N(t).call(this,e))||"object"!==w(n)&&"function"!=typeof n?O(r):n).state={current_user:e.settings.current_user,removal:e.data.flags.removal.active,removal_count:e.data.flags.removal.count,like:e.data.flags.like.active,like_users:e.data.flags.like.users||[],dislike:e.data.flags.dislike.active,dislike_users:e.data.flags.dislike.users||[],reply_form:{component:null,is_visible:!1}},a.action_like=a.action_like.bind(O(O(a))),a.action_dislike=a.action_dislike.bind(O(O(a))),a.handle_reply_click=a.handle_reply_click.bind(O(O(a))),console.log("Creating Comment"),a}var a,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,n.a.Component),a=t,(r=[{key:"_get_username_chunk",value:function(){var e=this.props.data.user_name,t="";if(this.props.data.user_url&&!this.props.data.is_removed&&(e=n.a.createElement("a",{href:this.props.data.user_url},e)),this.props.data.user_moderator){var a=m.a.gettext("moderator");t=n.a.createElement("span",null," ",n.a.createElement("span",{className:"badge badge-secondary"},a))}return n.a.createElement("span",null,e,t)}},{key:"_get_right_div_chunk",value:function(){var e="",t="",a="",r="";if(this.props.data.is_removed)return"";if(this.props.settings.is_authenticated&&this.props.settings.can_moderate&&this.state.removal_count>0){var s=m.a.ngettext("%s user has flagged this comment as inappropriate.","%s users have flagged this comment as inappropriate.",this.state.removal_count),i=m.a.interpolate(s,[this.state.removal_count]);e=n.a.createElement("span",{className:"badge badge-danger",title:i},this.state.removal_count)}if(this.props.settings.allow_flagging){var o="";this.state.removal?(o=m.a.gettext("I flagged it as inappropriate"),t=n.a.createElement("span",null,e,n.a.createElement("i",{className:"fas fa-flag text-danger",title:o}))):(r=this.props.settings.is_authenticated?this.props.settings.flag_url.replace("0",this.props.data.id):this.props.settings.login_url+"?next="+this.props.settings.flag_url.replace("0",this.props.data.id),o=m.a.gettext("flag comment as inappropriate"),t=n.a.createElement("a",{className:"mutedlink",href:r},n.a.createElement("i",{className:"fas fa-flag",title:o})))}if(this.props.settings.is_authenticated&&this.props.settings.can_moderate){var l=m.a.gettext("remove comment");r=this.props.settings.delete_url.replace("0",this.props.data.id),a=n.a.createElement("a",{className:"mutedlink",href:r},n.a.createElement("i",{className:"fas fa-trash-alt",title:l}))}return n.a.createElement("div",null,t," ",a)}},{key:"_get_feedback_chunk",value:function(e){if(!this.props.settings.allow_feedback)return"";var t=e+"_users",a="";if(this.props.settings.show_feedback){var r=this.state.current_user.split(":")[0],s=this.state[t].map(function(e){return e.split(":")[0]});if(this.state[e]&&-1==s.indexOf(r))this.state[t].push(this.state.current_user);else if(!this.state[e]&&s.indexOf(r)>-1){var i=s.indexOf(r);this.state[t].splice(i,1)}if(this.state[t].length){var o=this.state[t].map(function(e){return e.split(":")[1]});o=o.join("<br/>"),a=n.a.createElement("span",null," ",n.a.createElement("a",{className:"badge badge-primary text-white cfb-counter","data-toggle":"tooltip",title:o},this.state[t].length))}}var l=this.state[e]?"":"mutedlink",c="fas fa-"+("like"==e?"thumbs-up":"thumbs-down"),u="like"==e?this.action_like:this.action_dislike,p="";return p="like"==e?m.a.gettext("I like it"):m.a.gettext("I dislike it"),n.a.createElement("span",null,a," ",n.a.createElement("a",{href:"#",onClick:u,className:l},n.a.createElement("i",{className:c,title:p}))," ")}},{key:"render_feedback_btns",value:function(){if(this.props.settings.allow_feedback){var e="feedback-"+this.props.data.id;this.props.settings.show_feedback&&this.disposeTooltips(e);var t=this._get_feedback_chunk("like"),a=this._get_feedback_chunk("dislike");return n.a.createElement("span",{id:e,className:"small"},t,n.a.createElement("span",{className:"text-muted"},"|"),a)}return""}},{key:"make_form_invisible",value:function(e){this.props.on_comment_created()}},{key:"handle_reply_click",value:function(e){e.preventDefault();var t=this.state.reply_form.component,a=!this.state.reply_form.is_visible;null==t&&(t=n.a.createElement(k,E({},this.props.settings,{reply_to:this.props.data.id,on_comment_created:this.make_form_invisible.bind(this)}))),this.setState({reply_form:{component:t,is_visible:a}})}},{key:"_get_reply_link_chunk",value:function(){if(!this.props.data.allow_reply)return"";var e=this.props.settings.reply_url.replace("0",this.props.data.id),t=m.a.gettext("Reply");return this.props.settings.allow_feedback?n.a.createElement("span",null,"  ",n.a.createElement("span",{className:"text-muted"},"•"),"  ",n.a.createElement("a",{className:"small mutedlink",href:e,onClick:this.handle_reply_click},t)):n.a.createElement("a",{className:"small mutedlink",href:e,onClick:this.handle_reply_click},t)}},{key:"rawMarkup",value:function(){var e=(new d.a).render(this.props.data.comment);return{__html:e}}},{key:"render_comment_body",value:function(){var e="";if(this.props.data.allow_reply||this.props.settings.allow_feedback||(e="pb-3"),this.props.data.is_removed){var t="text-muted ".concat(e);return n.a.createElement("p",{className:t},n.a.createElement("em",null,this.props.data.comment))}var a="content ".concat(e);return n.a.createElement("div",{className:a,dangerouslySetInnerHTML:this.rawMarkup()})}},{key:"render_reply_form",value:function(){return this.state.reply_form.is_visible?n.a.createElement("div",null,this.state.reply_form.component):""}},{key:"_post_feedback",value:function(e){l.a.ajax({method:"POST",url:this.props.settings.feedback_url,data:{comment:this.props.data.id,flag:e},dataType:"json",cache:!1,statusCode:{201:function(){"like"==e?this.setState({like:!0,dislike:!1}):"dislike"==e&&this.setState({dislike:!0,like:!1})}.bind(this),204:function(){"like"==e?this.setState({like:!1}):"dislike"==e&&this.setState({dislike:!1})}.bind(this)},error:function(e,t,a){400==e.status&&e.responseJSON.non_field_errors.length?alert(e.responseJSON.non_field_errors[0]):console.error(this.props.settings.feedback_url,t,a.toString())}.bind(this)})}},{key:"action_like",value:function(e){return e.preventDefault(),this.props.settings.is_authenticated?this._post_feedback("like"):window.location.href=this.props.settings.login_url+"?next="+this.props.settings.like_url.replace("0",this.props.data.id)}},{key:"action_dislike",value:function(e){return e.preventDefault(),this.props.settings.is_authenticated?this._post_feedback("dislike"):window.location.href=this.props.settings.login_url+"?next="+this.props.settings.dislike_url.replace("0",this.props.data.id)}},{key:"is_hover",value:function(e){return e.parentElement.querySelector(":hover")===e}},{key:"disposeTooltips",value:function(e){var t=document.getElementById(e),a=t&&this.is_hover(t);t&&!a&&l()("#"+e+' A[data-toggle="tooltip"]').tooltip("dispose")}},{key:"componentDidMount",value:function(){var e="feedback-"+this.props.data.id;l()("#"+e).tooltip({html:!0,selector:".cfb-counter"})}},{key:"componentDidUpdate",value:function(){var e="feedback-"+this.props.data.id;l()("#"+e).tooltip({html:!0,selector:".cfb-counter"})}},{key:"componentWillUnmount",value:function(){var e="feedback-"+this.props.data.id,t=document.getElementById(e),a=t&&this.is_hover(t);t&&!a&&l()("#"+e+' A[data-toggle="tooltip"]').tooltip("dispose")}},{key:"render",value:function(){var e="c"+this.props.data.id,a=this._get_username_chunk(),r=this._get_right_div_chunk(),s=this.render_comment_body(),i="",o="",l="";this.props.data.is_removed||(i=this.render_feedback_btns(),o=this._get_reply_link_chunk(),l=this.render_reply_form());var c="";this.props.newcids.indexOf(this.props.data.id)>-1&&(c=n.a.createElement("span",null,n.a.createElement("span",{className:"badge badge-success"},"new")," - "));var u="",m=this.props.settings;return null!=this.props.data.children&&(u=this.props.data.children.map(function(e){return n.a.createElement(t,{key:e.id,data:e,settings:m,newcids:this.props.newcids,on_comment_created:this.props.on_comment_created})}.bind(this))),n.a.createElement("div",{className:"media",id:e},n.a.createElement("img",{src:this.props.data.user_avatar,className:"mr-3",height:"48",width:"48"}),n.a.createElement("div",{className:"media-body"},n.a.createElement("div",{className:"comment pb-3"},n.a.createElement("a",{name:e}),n.a.createElement("h6",{className:"mb-1 small d-flex"},n.a.createElement("div",{className:"mr-auto"},c,this.props.data.submit_date," - ",a,"  ",n.a.createElement("a",{className:"permalink",href:this.props.data.permalink},"¶")),r),s,i,o,l),u))}}])&&x(a.prototype,r),s&&x(a,s),t}();function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function C(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var I=function(e){function t(e){var a,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=!(n=M(t).call(this,e))||"object"!==P(n)&&"function"!=typeof n?D(r):n,c("csrftoken"),a.state={previewing:!1,preview:{name:"",email:"",url:"",comment:""},tree:[],cids:[],newcids:[],counter:a.props.comment_count},a.handle_comment_created=a.handle_comment_created.bind(D(D(a))),a.handle_preview=a.handle_preview.bind(D(D(a))),a.handle_update=a.handle_update.bind(D(D(a))),a}var a,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(t,n.a.Component),a=t,(r=[{key:"handle_comment_created",value:function(){this.load_comments()}},{key:"handle_preview",value:function(e,t,a,r){this.setState({preview:{name:e,email:t,url:a,comment:r},previewing:!0})}},{key:"handle_update",value:function(e){e.preventDefault(),this.load_comments()}},{key:"reset_preview",value:function(){this.setState({preview:{name:"",email:"",url:"",comment:""},previewing:!1})}},{key:"render_comment_counter",value:function(){if(this.state.counter>0){var e=m.a.ngettext("%s comment.","%s comments.",this.state.cids.length),t=m.a.interpolate(e,[this.state.cids.length]);return n.a.createElement("h5",{className:"text-center"},t)}return""}},{key:"render_comment_form",value:function(){return this.props.allow_comments?n.a.createElement(k,T({},this.props,{on_comment_created:this.handle_comment_created})):n.a.createElement("h5",null,"Comments are disabled for this article.")}},{key:"render_update_alert",value:function(){var e=this.state.counter-this.state.cids.length;if(e>0){var t=m.a.ngettext("There is %s new comment.","There are %s new comments.",e),a=m.a.interpolate(t,[e]);return n.a.createElement("div",{className:"alert alert-info d-flex align-items-center"},n.a.createElement("p",{className:"mr-auto"},a),n.a.createElement("button",{type:"button",className:"btn btn-secondary btn-xs",onClick:this.handle_update},"update"))}return""}},{key:"create_tree",value:function(e){var t=new Array,a=new Array,r={},n={},s=[],i=[],o=[];function l(e){return n[e].map(function(e){return null==r[e].children&&(r[e].children=l(e)),r[e]})}var c=!0,u=!1,m=void 0;try{for(var p,d=e[Symbol.iterator]();!(c=(p=d.next()).done);c=!0){var h=p.value;s.push(h.id),r[h.id]=h,0==h.level&&a.push(h.id),n[h.id]=[],h.parent_id!==h.id&&n[h.parent_id].push(h.id)}}catch(e){u=!0,m=e}finally{try{c||null==d.return||d.return()}finally{if(u)throw m}}for(var f=0;f<a.length;f++){var _=a[f];r[_].children=l(_),t.push(r[_])}if(s.length)if(this.state.cids.length)for(var v=0;v<s.length;v++){var y=s[v];-1==this.state.cids.indexOf(y)&&o.push(y),i.push(y)}else i=s,o=[];this.setState({tree:t,cids:i,newcids:o,counter:i.length})}},{key:"load_comments",value:function(){l.a.ajax({url:this.props.list_url,dataType:"json",cache:!1,success:function(e){this.create_tree(e)}.bind(this),error:function(e,t,a){console.error(this.props.list_url,t,a.toString())}.bind(this)})}},{key:"load_count",value:function(){l.a.ajax({url:this.props.count_url,dataType:"json",cache:!1,success:function(e){this.setState({counter:e.count})}.bind(this),error:function(e,t,a){console.error(this.props.count_url,t,a.toString())}.bind(this)})}},{key:"componentDidMount",value:function(){this.load_comments(),this.props.polling_interval&&setInterval(this.load_count.bind(this),this.props.polling_interval)}},{key:"render",value:function(){var e=this.props,t=this.render_comment_counter(),a=this.render_update_alert(),r=this.render_comment_form(),s=this.state.tree.map(function(t){return n.a.createElement(j,{key:t.id,data:t,settings:e,newcids:this.state.newcids,on_comment_created:this.handle_comment_created})}.bind(this));return n.a.createElement("div",null,t,r,a,n.a.createElement("div",{className:"comment-tree"},n.a.createElement("div",{className:"media-list"},s)))}}])&&C(a.prototype,r),s&&C(a,s),t}();i.a.render(n.a.createElement(I,Object.assign(window.comments_props,window.comments_props_override)),document.getElementById("comments"))}});
//# sourceMappingURL=plugin-2.3.1.js.map